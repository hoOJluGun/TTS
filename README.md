# Telegram Channel -> Markdown Export

Этот репозиторий содержит скрипт, который заходит в канал Telegram и выгружает все текстовые сообщения в один большой Markdown‑файл, добавляя каждое следующее сообщение с новой строки (по умолчанию — пустая строка между сообщениями).

## Возможности
- Чтение канала (публичного или того, где вы участник) через MTProto (Telethon)
- Проход от самого первого сообщения к последнему
- Построчное добавление в файл без загрузки всех сообщений в память
- Опционально: метаданные (id, дата) и свой разделитель между сообщениями

## Ограничение Bot API
Официальный Bot API не позволяет читать историю каналов. Для доступа к полной истории нужен пользовательский клиент MTProto (например, Telethon), авторизованный по вашему номеру телефона/сессии. Поэтому здесь используется Telethon.

## Установка
1) Установите зависимости:
```
pip install -r requirements.txt
```

2) Получите `TELEGRAM_API_ID` и `TELEGRAM_API_HASH` на https://my.telegram.org (раздел API Development Tools).

3) Установите переменные окружения (пример для macOS/Linux):
```
export TELEGRAM_API_ID=123456
export TELEGRAM_API_HASH=your_api_hash
# Необязательно: имя файла сессии Telethon (по умолчанию telegram_session)
export TELEGRAM_SESSION=telegram_session
```

При первом запуске Telethon спросит ваш номер телефона и код подтверждения, чтобы создать локальный файл сессии.

## Использование
Базовый запуск:
```
python telegram_export_md.py https://t.me/<channel_username> -o output.md
```

Поддерживаются формы канала: `@username`, `username`, `https://t.me/username`, а также инвайт‑ссылки (если у вашей сессии есть доступ).

Полезные опции:
- `--separator "\n\n---\n\n"` — задать свой разделитель между сообщениями
- `--include-meta` — добавить к каждому сообщению строку с метаданными (id, дата)
- `--try-join` — попытаться присоединиться к публичному каналу перед выгрузкой

Пример:
```
python telegram_export_md.py @some_channel -o dump.md --include-meta --separator "\n\n" --try-join
```

## Примечания
- Скрипт сохраняет только текст и подписи к сообщениям. Медиа без текста пропускаются.
- Для приватных/закрытых каналов требуется, чтобы ваша сессия уже имела доступ (вы должны быть участником).
- Файл может получиться очень большим — запись идёт потоково, чтобы не расходовать много памяти.
